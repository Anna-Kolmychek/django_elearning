# Проект "Платформа онлайн-обучения"

## Запуск проекта

1. Скопируйте проект, установите виртуальное окружение и зависимости из `requirements.txt`.

2. В файле `config/settings.py` при необходимости измените настройки базы данных. 
В проекте используется локальный `postgresql`, база с именем `django_elearning`, 
пользователь `postgres` с входом для локального подключения без пароля
```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'django_elearning',
        'USER': 'postgres',
    }
}
```

3. Создайте пустую базу данных с именем `django_elearning` (при локольном входе в `postgresql` без пароля):
```
psql -U postgres
create database django_elearning;
\q
```

4. Примените миграции
```
python3 manage.py migrate
```

5. При желании создайте суперпользователя (admin@email.com, 12345),
группу модераторов, пользователя модератор (moderator@email.com, 12345) и тестовые данные:
двух тестовых пользователей (user1@email.com/user2@email.com, 12345), курсы, уроки, платежи.
Последовательность и наличие всех команд принципиально.
```
python3 manage.py create_su
python3 manage.py create_moderator_group
python3 manage.py create_moderator
python3 manage.py create_test_users
python3 manage.py loaddata data_education_test.json
python3 manage.py create_test_payments
```

6. Запустите сервер
```
python3 manage.py runserver
```


## ДЗ 25.2 Валидаторы, пагинация и тест

- Для уроков и курсов добавлена проверка на отсутствие ссылок, кроме ссылок на youtube

- Добавлено приложение subscriptions, модель подписок (пользователь-курс), эндпоинты для создания и удаления подписок

- В курсах отображается флаг: есть или нет подписки у пользователя на курс

- Добавлена пагинация для курсов и уроков

- Добавлены тесты для CRUD уроков

- Добавлены тесты для подписок (созадние/удаление/отображение в курсе)


## Сделано ранее

## ДЗ 25.1 Права доступа в DRF

- Добавлена jwt-авторизация

- Все эндпоинты закрыты для неавторизованных пользователей (за исключением создания пользователя)

- Добавлена группа модераторов (кастомная команда create_moderator_group) 
и пользователь-модератор (кастомная команда create_moderator)

- Для курсов и уроков доступ ограничен следующим образом:
  - Создание: модератор не может создавать новую запись. Авторизованный пользователь, но не модератор, может создавать запись.
  - Просмотр: модератор может видеть все записи, пользователь только свои
  - Редактирование: модератор может редактировать все записи, пользователь только свои
  - Удаление: модератор не может удалить никакую запись. Авторизованный пользователь, 
  но не модератор, может удалить только свою запись.

- Для эндпоинтов пользователей:
  - Авторизованные пользователи могут просматривать любой профиль, но без пароля, платежей и фамилии. В общем списке (list)
  также выводятся сокращенные профили.
  - Просмотр свего профиля (retrieve) доступен в полном объеме 


### ДЗ 24.2 Сериализаторы

- Для модели курса в сериализатор добавлено 
  - вывод количества уроков в курсе
  - вывод списка уроков курса

- Добавлена кастомная команда для создания суперпользователя

- Создано новое приложение payments
  - описана модель по ТЗ
  - создана кастомная команда для тестовой записи платежей в БД (!!! для корректной работы
  в БД должен быть мимиум 1 пользователь, 1 урок и 1 курс !!!)
  - реализован CRUD через ViewSet
  - настроена фильтрация списка платежей с возможностями
    - менять порядок сортировки по дате оплаты
    - фильтровать по курсу или уроку
    - фильтровать по способу оплаты

- Для пользователя сделан вывод истории платежей


### ДЗ 24.1 Вьюсеты и дженерики

- Создан gjango-проект, подчключен DRF

- Созданы приложения
  - users
  - eductaion

- Созданы модели
  - User (авторизация по email, расширено полями phone, city, photo) - в приложении users
  - Course - в приложении eductaion
  - Lesson - в приложении eductaion

- Реализован CRUD для модели Course через ViewSet

- Реализован CRUD для модели Lesson через Generic-классы

- Реализован CRUD для модели User через ViewSet 

